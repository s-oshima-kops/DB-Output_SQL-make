# 要件定義書：端末マスタ管理業務の半自動化ツール

---

## 1. 背景と目的

本業務は、ユーザーからの端末アプリインストール依頼に伴う端末マスタ更新作業を対象とする。  
従来の作業は手動による情報記入・SQL作成・更新が中心であり、作業ミスや非効率が発生していた。

本要件定義書は、ExcelおよびBATファイルのみを使用した**半自動化ツール**の構築要件を明確にし、  
現場オペレーションの効率化とミス削減を目的とする。

---

## 2. 使用環境・制約

- 使用可能なツール：Microsoft Excel（VBA利用可能）、Windowsバッチファイル（.bat）
- ネットワーク：Oracle DBは別サーバに存在し、直接接続は不可
- ファイル入出力：共有フォルダを利用してデータ連携を実施
- 文字コード：CSVではなく `.xlsx` または `.xlsm` 形式で出力・管理

---

## 3. 機能要件

### 3.1 ヒアリングシート取り込み
- ユーザー提供の `.txt` 形式ファイルからExcelへデータ取り込み
- 「項目名：値」形式に対応し、A列＝項目名、B列＝値として展開

### 3.2 マスタ情報の取得
- Oracle DBに対して SQL*Plus + BAT によりCSVを出力
- 出力ファイル：`AutoDB_output/mst_terminal.csv`
- Excelマクロで `.csv` → `.xlsx` に自動変換（`terminal_master_before.xlsx`）

### 3.3 SQL出力支援（オプション）
- 入力情報からSQLテンプレートにプレースホルダを埋め込んで出力
- 出力先は `.sql` テキストファイル or Excelシート

### 3.4 差分比較
- DB更新前・後の `.xlsx` ファイルを比較し、差分行を検出
- 差分結果を `terminal_diff.xlsx` に出力
- 差分はセル単位で比較し、変更箇所にハイライト表示

---

## 4. 非機能要件

- 処理時間：1件あたり3分以内で完結すること
- 操作性：マクロボタン・チェックボックスなどのUIを導入し、現場で直感的に使える設計とする
- 保守性：SQLテンプレートや判定条件をExcelシート上で管理可能とする
- セキュリティ：DB更新処理自体は自動化せず、**手動で実施**

---

## 5. ファイル構成（概要）

- `export_terminal.bat`：マスタCSV出力用バッチ
- `export_terminal.sql`：Oracle SQL（SPOOLで出力）
- `import_master.xlsm`：各種マクロを内包したExcelブック
- `AutoDB_output/`：データ保存用フォルダ（CSV, XLSX, 差分など）

---

## 6. 将来的な拡張案（参考）

- 入力チェックロジック強化（未入力、形式ミス検出など）
- ログ出力機能（出力日時、作業者など）
- チーム・エリア別の固有番号ルール対応
- マスタ自動取得のスケジューリング（タスクスケジューラ＋BAT）

---

（以上）
