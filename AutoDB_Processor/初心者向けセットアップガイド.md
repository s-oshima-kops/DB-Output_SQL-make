# 🔰 初心者向けセットアップガイド

## 📋 はじめに
このガイドでは、**端末マスタ管理半自動化ツール**を初めて使用する方でも簡単にセットアップできるよう、手順を詳しく説明します。

**⚠️ 重要**: 分からないことがあれば、無理をせずにシステム管理者に相談してください。

---

## 🛠 必要な準備

### 1. 必要なソフトウェア
- ✅ **Microsoft Excel** (VBAマクロが有効)
- ✅ **Oracle SQL\*Plus** (データベース接続用)
- ✅ **Windows OS** (バッチファイル実行用)

### 2. 権限・アクセス
- ✅ Oracleデータベースへの読み取り権限
- ✅ 共有フォルダへの読み書き権限
- ✅ Excelマクロの実行権限

---

## 📁 ファイル配置

### ステップ1: フォルダ構成の確認
以下のような構成になっていることを確認してください：

```
AutoDB_Processor/
├── export_terminal.bat              ← バッチファイル
├── export_terminal.sql              ← SQLファイル
├── VBA_Code_for_import_master.vbs   ← VBAコード
├── config.txt                       ← 設定ファイル
├── templates/
│   └── sql_template.txt             ← SQLテンプレート
├── AutoDB_output/                   ← 出力フォルダ（空でOK）
└── sample_hearing_sheet.txt         ← サンプルファイル
```

**確認方法**: エクスプローラーでフォルダを開き、上記のファイルがあることを確認

---

## ⚙️ 設定変更（重要）

### ステップ2: データベース接続設定
**ファイル**: `export_terminal.bat`

1. **右クリック** → **編集** でファイルを開く
2. 以下の部分を探す：

```batch
rem --- データベース接続設定 ---
set DB_USER=your_username
set DB_PASS=your_password
set DB_CONNECT=your_server:1521/your_service
```

3. **実際の値に変更**:
```batch
set DB_USER=実際のユーザー名
set DB_PASS=実際のパスワード
set DB_CONNECT=実際のサーバー名:1521/実際のサービス名
```

**例**:
```batch
set DB_USER=terminal_user
set DB_PASS=mypassword123
set DB_CONNECT=dbserver01:1521/ORCL
```

4. **保存**: Ctrl+S で保存

**⚠️ 注意**: パスワードが分からない場合は、システム管理者に確認してください。

### ステップ3: SQLファイルの調整
**ファイル**: `export_terminal.sql`

1. ファイルを**右クリック** → **編集**
2. 以下の部分を確認:

```sql
FROM MST_Terminal    -- ← テーブル名をここで変更
```

3. **実際のテーブル名に変更** (システム管理者に確認)
4. **保存**: Ctrl+S で保存

---

## 📊 Excelブックの作成

### ステップ4: マクロ付きExcelブックの準備

#### 4-1. 新しいExcelブックを作成
1. **Excel** を起動
2. **新しいブック** を作成
3. **ファイル** → **名前を付けて保存**
4. **ファイル名**: `import_master.xlsm`
5. **ファイルの種類**: `Excel マクロ有効ブック (*.xlsm)`
6. **保存場所**: `AutoDB_Processor` フォルダ内

#### 4-2. VBAコードの追加
1. **Alt + F11** を押してVBAエディターを開く
2. **挿入** → **標準モジュール** をクリック
3. **右側の画面** に `VBA_Code_for_import_master.vbs` の内容をコピー＆ペースト
4. **Ctrl + S** で保存
5. **Alt + F11** でVBAエディターを閉じる

#### 4-3. ワークシートの準備
1. **シート名** を以下に変更:
   - Sheet1 → `制御パネル`
   - Sheet2 → `ヒアリング情報`
2. 必要に応じて新しいシートを**右クリック** → **挿入** で追加

---

## 🚀 動作テスト

### ステップ5: 初回テスト実行

#### 5-1. バッチファイルのテスト
1. `export_terminal.bat` を**ダブルクリック**
2. 以下のような画面が表示されることを確認:
```
========================================
端末マスタ情報エクスポート処理開始
開始時刻: [2024/01/01 10:00:00]
========================================
```

3. **成功した場合**: `AutoDB_output\mst_terminal.csv` が作成される
4. **失敗した場合**: エラーメッセージを確認し、設定を見直す

#### 5-2. Excelマクロのテスト
1. `import_master.xlsm` を開く
2. **開発** タブ → **マクロ** をクリック
3. `InitializeWorkbook` を選択して **実行**
4. 制御パネルが正しく表示されることを確認

---

## 🔧 よくあるトラブルと対処法

### Q1: バッチファイルでエラーが出る
**症状**: 「データベースに接続できません」
**対処法**:
1. データベース接続情報を再確認
2. SQL*Plusが正しくインストールされているか確認
3. ネットワーク接続を確認

### Q2: Excelでマクロが実行できない
**症状**: 「マクロが無効になっています」
**対処法**:
1. **ファイル** → **オプション** → **セキュリティセンター**
2. **マクロの設定** → **すべてのマクロを有効にする**
3. Excelを再起動

### Q3: CSVファイルが文字化けする
**症状**: 日本語が「???」で表示される
**対処法**:
1. CSVファイルを開く際に **データ** → **テキストファイル**
2. **文字コード** を **Shift_JIS** に設定

### Q4: ファイルが見つからないエラー  
**症状**: 「指定されたファイルが見つかりません」
**対処法**:
1. ファイルパスを確認（日本語や特殊文字が含まれていないか）
2. ファイルが正しい場所にあるか確認
3. ファイル名に間違いがないか確認

---

## 📞 サポート

### 問い合わせ前の確認事項
- [ ] このガイドの手順を全て実行したか
- [ ] エラーメッセージを正確に記録したか
- [ ] ファイルの配置に間違いがないか
- [ ] 設定値が正しいか

### 連絡先
- **システム管理者**: [連絡先を記入]
- **内線**: [番号を記入]
- **メール**: [アドレスを記入]

### 問い合わせ時に伝えること
1. **何をしようとしたか**
2. **どのような操作をしたか**
3. **どのようなエラーが発生したか**
4. **エラーメッセージの内容** (スクリーンショット推奨)

---

## 📚 参考資料

### 関連ドキュメント
- `README.md` - 詳細な技術仕様
- `config.txt` - 設定項目の説明
- `sample_hearing_sheet.txt` - ヒアリングシートの例

### 操作手順書
基本的な使い方は以下の順序で実行:
1. `export_terminal.bat` でデータ取得
2. Excel で「CSV→Excel変換」
3. 手動でDB更新作業
4. 再度 `export_terminal.bat` でデータ取得
5. Excel で「差分比較実行」

---

**🎉 セットアップ完了！** 

困ったときは、このガイドを見返すか、システム管理者に相談してください。 